/*
 Hype Video Controller v1.0.9
 Copyright (2025) Max Ziebell. MIT-license
*/
'use strict';"HypeVideoController"in window===!1&&(window.HypeVideoController=function(){function p(a){a.querySelectorAll("video").forEach(c=>{c.pause();c.currentTime=0})}function q(a){if(g.autoObserver){var c=document.getElementById(a.documentId()),e=new MutationObserver(d=>{d.forEach(f=>{f.type==="attributes"&&f.attributeName==="style"&&f.target.classList.contains("HYPE_scene")&&(f=f.target,window.getComputedStyle(f).display==="none"&&p(f))})});c=c.getElementsByClassName("HYPE_scene");var b={attributes:!0,
attributeFilter:["style"]};Array.from(c).forEach(d=>{e.observe(d,b)});r.set(a,e)}}function h(a,c,e){var b=(b=e.closest(".HYPE_scene"))?window.getComputedStyle(b).display!=="none":!1;b&&(a.triggerCustomBehaviorNamed(c),(e=e.getAttribute("data-video-name"))&&a.triggerCustomBehaviorNamed(`${c} ${e}`),window.HypeReactiveContent&&a.refreshReactiveContentDebounced())}function t(a,c){if(k(a,"endOnStall")){l(a);var e=a.currentTime,b=setTimeout(()=>{a.paused||a.currentTime!==e||(console.warn('Video playback stalled. Triggering "Video Ended".',
a),a.pause(),h(c,"Video Ended",a))},g.stallTimeout||2E3);m.set(a,b)}}function l(a){m.has(a)&&(clearTimeout(m.get(a)),m.delete(a))}function u(a){a.getElementById(a.currentSceneId()).querySelectorAll("video").forEach(c=>{n.has(c)||(c.addEventListener("ended",()=>{l(c);h(a,"Video Ended",c)}),c.addEventListener("playing",()=>{l(c);c.paused||c.ended||c.hasAttribute("data-autoplay-failed")||h(a,"Video Started",c);c.removeAttribute("data-autoplay-failed")}),c.addEventListener("pause",()=>{l(c);h(a,"Video Paused",
c)}),c.addEventListener("waiting",()=>{t(c,a)}),n.add(c))})}function k(a,c){const e=`data-video-${c.toLowerCase()}`;a=a.getAttribute(e);return a!==null?a==="true":g[c]}function v(a){a.getElementById(a.currentSceneId()).querySelectorAll("video").forEach(c=>{k(c,"autoMute")&&(c.muted=!0);k(c,"autoPlaysInline")&&(c.playsInline=!0);requestAnimationFrame(()=>{if(k(c,"autoPlay")){c.removeAttribute("autoplay");c.autoplay=!1;c.currentTime=0;const e=c.play();e!==void 0&&e.catch(b=>{console.warn(`Autoplay failed for video: ${c.id||
"unnamed"}`,b);c.setAttribute("data-autoplay-failed","true");k(c,"endOnAutoplayFail")&&(console.log('Triggering "Video Ended" due to autoplay failure.'),setTimeout(()=>{h(a,"Video Ended",c)},0))})}})})}function w(a,c){a.getElementById(a.currentSceneId()).querySelectorAll("video").forEach(e=>{e.pause();c&&(e.currentTime=0);e.removeAttribute("data-autoplay-failed")})}const n=new WeakSet,r=new WeakMap,m=new WeakMap,g={autoPlay:!0,autoMute:!0,autoPlaysInline:!0,autoObserver:!0,endOnStall:!0,stallTimeout:2E3,
endOnAutoplayFail:!0};"HYPE_eventListeners"in window===!1&&(window.HYPE_eventListeners=[]);window.HYPE_eventListeners.push({type:"HypeDocumentLoad",callback:function(a,c,e){q(a);a.getVideo=function(b){const d=this.getElementById(this.currentSceneId());return b?b.match(/^[.#\[]/)||b.includes(" ")?d.querySelector(b):d.querySelector(`video[data-video-name="${b}"]`):d.querySelector("video")};a.isVideoPlaying=function(b){return(b=this.getVideo(b))?!b.paused&&!b.ended:!1};a.playVideo=function(b){const d=
this.getVideo(b);d&&d.play().catch(f=>{console.warn(`Failed to play video "${b}":`,f)})};a.pauseVideo=function(b){(b=this.getVideo(b))&&b.pause()};a.stopVideo=function(b){if(b=this.getVideo(b))b.pause(),b.currentTime=0};a.setVideoVolume=function(b,d){(b=this.getVideo(b))&&d>=0&&d<=1&&(b.volume=d)};a.seekVideoTo=function(b,d){(b=this.getVideo(b))&&d>=0&&d<=b.duration&&(b.currentTime=d)};a.toggleVideoMute=function(b){if(b=this.getVideo(b))b.muted=!b.muted};a.getVideoDuration=function(b){return(b=this.getVideo(b))?
b.duration:null};a.seekVideoToPercentage=function(b,d){return(b=this.getVideo(b))&&d>=0&&d<=100?(d=d/100*b.duration,b.currentTime=d):null};a.muteAllVideos=function(){this.getElementById(this.currentSceneId()).querySelectorAll("video").forEach(b=>{b.muted=!0})};a.unmuteAllVideos=function(){this.getElementById(this.currentSceneId()).querySelectorAll("video").forEach(b=>{b.muted=!1})}}});window.HYPE_eventListeners.push({type:"HypeScenePrepareForDisplay",callback:function(a,c,e){u(a);v(a)}});window.HYPE_eventListeners.push({type:"HypeSceneLoad",
callback:function(a,c,e){c.querySelectorAll("video").forEach(b=>{b.removeAttribute("autoplay");b.autoplay=!1})}});window.HYPE_eventListeners.push({type:"HypeSceneUnload",callback:function(a,c,e){w(a)}});return{version:"1.0.9",setDefault:function(a,c){typeof a==="object"?Object.assign(g,a):g[a]=c},getDefault:function(a){return a?g[a]:{...g}}}}());
